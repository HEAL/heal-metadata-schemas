"$schema": http://json-schema.org/draft-04/schema#
"$id": vlmd-fields
title: HEAL Variable Level Metadata Fields
description: |
  Variable level metadata individual fields integrated into the variable level
  metadata object within the HEAL platform metadata service.

  > Note, only `name` and `description` are required.
  >  Listed at the end of the description are suggested "priority" levels in brackets (e.g., [<priority>]):
    1. [Required]: Needs to be filled out to be valid.
    2. [Highly recommended]: Greatly help using the data dictionary but not required. 
    3. [Optional, if applicable]: May only be applicable to certain fields.
    4. [Autopopulated, if not filled]: These fields are intended to be autopopulated from other fields but can be filled out if desired.
    5. [Experimental]: These fields are not currently used but are in development.


type: object
additionalProperties: true
required:
  - name
  - description
properties:
  module: 
    type: string 
    title: Module 
    description: |
      The section, form, survey instrument, set of measures  or other broad category used 
      to group variables.
    
    examples:
      - Demographics
      - PROMIS
      - Substance use
      - Medical History
      - Sleep questions
      - Physical activity

  name:
    type: string
    title: Variable Name
    description: |
      The name of a variable (i.e., field) as it appears in the data. 
      
      [Required]
  title:
    type: string
    title: Variable Label (ie Title)
    description: |
      The human-readable title or label of the variable. 
      
      [Highly recommended]
    examples:
    - My Variable
    - Gender identity
  description:
    type: string
    title: Variable Description
    description: |
      An extended description of the variable. This could be the definition of a variable or the 
      question text (e.g., if a survey). 
      
      [Required]
    examples:
      - The participant's age at the time of study enrollment
      - What is the highest grade or level of school you have completed or the highest degree you have received?
  type:
    title: Variable Type
    description: |
      The data type of the variable. This categorization allows the researcher to know what operations can be performed
      with the variable (i.e., statistical test) in addition to telling the computer how to effectively store these data.
      
      [Highly recommended]
    $ref: "#/definitions/frictionlessTypes"
  format:
    title: Variable Format
    description: |
      Indicates the format of the type specified in the `type` property.

      Each format is dependent on the `type` specified. For example:
      If `type` is "string", then see the String formats. 
      If `type` is one of the date-like formats, then see Date formats.

      Sources:

      - [Frictionless standard formats associated with types](https://specs.frictionlessdata.io/table-schema/#types-and-formats)
    anyOf:
        - $ref: "#/definitions/stringFormat"
        - $ref: "#/definitions/dateFormat"
        - $ref: "#/definitions/geopointFormat"
        - $ref: "#/definitions/geojsonFormat"

  constraints:
    type: object
    properties:
      maxLength:
        type: integer
        title: Maximum Length
        description: |
          Indicates the maximum length of an iterable (e.g., array, string, or
          object). For example, if 'Hello World' is the longest value of a
          categorical variable, this would be a maxLength of 11.

          [Optional,if applicable]
      enumJsonSpec:
        title: Variable Possible Values
        description: |
          Constrains possible values to a set of values.

          [Optional,if applicable]
        type: array
        examples:
         - [1,2,3,4]
         - ["White","Black or African American","American Indian or Alaska Native","Native Hawaiian or Other Pacific Islander","Asian","Some other race","Multiracial"]
      enumCsvSpec:
        title: Variable Possible Values
        description:  |
          Constrains possible values to a set of values.

          [Optional,if applicable]
        $ref: "#/definitions/csvArray"
        examples: 
        - 1|2|3|4|5|6|7|8
        - White|Black or African American|American Indian or Alaska Native|Native Hawaiian or Other Pacific Islander|Asian|Some other race|Multiracial
      pattern:
        type: string
        title: Regular Expression Pattern
        description:   |
          A regular expression pattern the data MUST conform to.
          
          [Optional,if applicable]
      maximum:
        type: integer
        title: Maximum Value
        description: |
          Specifies the maximum value of a field (e.g., maximum -- or most
          recent -- date, maximum integer etc). Note, this is different then
          maxLength property.

          [Optional,if applicable]
      minimum:
        type: integer
        title: Minimum Value
        description: |
          Specifies the minimum value of a field.

          [Optional,if applicable]
  encodingsJsonSpec:
    title: 'Variable Value Encodings (i.e., mappings; value labels)'
    description: |
      Variable value encodings provide a way to further annotate any value within a any variable type,
      making values easier to understand. 

      
      Many analytic software programs (e.g., SPSS,Stata, and SAS) use numerical encodings and some algorithms
      only support numerical values. Encodings (and mappings) allow categorical values to be stored as
      numerical values.
      
      Additionally, as another use case, this field provides a way to
      store categoricals that are stored as  "short" labels (such as
      abbreviations).

      [Optional,if applicable]
    type: object
    examples: 
      - {"0":"No","1":"Yes"}
      - {"HW":"Hello world","GBW":"Good bye world","HM":"Hi, Mike"}
  encodingsCsvSpec:
    title: 'Variable Value Encodings (i.e., mappings; value labels)'
    description: |
      Variable value encodings provide a way to further annotate any value within a any variable type,
      making values easier to understand. 

      
      Many analytic software programs (e.g., SPSS,Stata, and SAS) use numerical encodings and some algorithms
      only support numerical values. Encodings (and mappings) allow categorical values to be stored as
      numerical values.
      
      Additionally, as another use case, this field provides a way to
      store categoricals that are stored as  "short" labels (such as
      abbreviations).

      [Optional,if applicable]
    $ref: "#/definitions/csvObject"
    examples:
      - '0=No|1=Yes'
      - 'HW=Hello world|GBW=Good bye world|HM=Hi,Mike'  
  ordered:
    title: An ordered variable
    description: |
      Indicates whether a categorical variable is ordered. This variable  is
      relevant for variables that have an ordered relationship but not
      necessarily  a numerical relationship (e.g., Strongly disagree < Disagree
      < Neutral < Agree).

      [Optional,if applicable]
    type: boolean
  missingValuesJsonSpec:
    title: Missing Values
    description: |
      A list of missing values specific to a variable.

      [Highly recommended]

    examples:

    - ["Missing","Skipped","No preference"]
    - ["Missing"]
    type: array
  missingValuesCsvSpec:
    title: Missing Values
    description: |
      A list of missing values specific to a variable.

      [Optional, if applicable]

    examples:

    - Missing|Skipped|No preference
    - Missing
    $ref: "#/definitions/csvArray"
  trueValuesJsonSpec:
    title: Boolean True Value Labels
    description: |
      For boolean (true) variable (as defined in type field), this field allows
      a physical string representation to be cast as true (increasing
      readability of the field). It can include one or more values.

      [Optional, if applicable]

    type: array
    items:
      type: string
    examples:
    - ["required","Yes","Checked"]
    - ["required"]

  trueValuesCsvSpec: 
    $ref: "#/definitions/csvArray"
    description: |
      For boolean (true) variable (as defined in type field), this field allows
      a physical string representation to be cast as true (increasing
      readability of the field). It can include one or more values.

      [Optional, if applicable]
      
    examples: 
      - Required|REQUIRED
      - required|Yes|Y|Checked
      - Checked
      - Required
  falseValuesJsonSpec:
    title: Boolean False Value Labels
    description: |
      For boolean (false) variable (as defined in type field), this field allows
      a physical string representation to be cast as false (increasing
      readability of the field) that is not a standard false value. It can include one or more values.
    type: array
  falseValuesCsvSpec:
    title: Boolean False Value Labels
    description: |
      For boolean (false) variable (as defined in type field), this field allows
      a physical string representation to be cast as false (increasing
      readability of the field) that is not a standard false value. It can include one or more values.
    $ref: "#/definitions/csvArray"
  repo_link:
    type: string
    title: Variable Repository Link
    description: |
      A link to the variable as it exists on the home repository, if applicable
  standardsMappings:
    title: Standards Mappings
    description: A published set of standard variables such as the NIH Common Data Elements program.
          
          [Autopopulated, if not filled]
    type: array
    items:
      type: object
      properties:
        url:
          title: Standards Mapping - Url
          description: |
            The url that links out to the published, standardized mapping.

            [Autopopulated, if not filled]
          type: string
          format: uri
          examples:
            - https://cde.nlm.nih.gov/deView?tinyId=XyuSGdTTI
        type:
          title: Standards Mapping - Title
          description: |
            The **type** of mapping linked to a published set of standard variables such as the NIH Common Data Elements program.
            [Autopopulated, if not filled]

          examples:
          - cde
          - ontology
          - reference_list
          type: string 
        label:
          title: Standards Mapping - Label
          description: |
            A free text **label** of a mapping indicating a mapping(s) to a published set of standard variables such as the NIH Common Data Elements program.
            
            [Autopopulated, if not filled]
          type: string
          examples: 
            - substance use
            - chemical compound
            - promis
        source:
          title: Standard Mapping - Source 
          description: |
            The source of the standardized variable.
          type: string
          examples:
            - TBD (will have controlled vocabulary)
        id:
          title: Standard Mapping - Id
          type: string
          description: |
            The id locating the individual mapping within the given source.
  relatedConcepts:
    title: Related Concepts
    description: Mappings to a published set of concepts related to the given field such as 
            ontological information (eg., NCI thesaurus, bioportal etc)
          
          [Autopopulated, if not filled]

    type: array
    items:
      type: object
      properties:
        url:
          title: Related Concepts - Url
          description: |
            The url that links out to the published, standardized concept.

            [Autopopulated, if not filled]
          type: string
          format: uri
          examples:
            - https://cde.nlm.nih.gov/deView?tinyId=XyuSGdTTI
        type:
          title: Related concepts - Type
          description: |
            The **type** of mapping to a published set of concepts related to the given field such as 
            ontological information (eg., NCI thesaurus, bioportal etc)

            [Autopopulated, if not filled]
          type: string 
        label:
          type: string
          title: Related Concepts - Label
          description: |
            A free text **label** of mapping to a published set of concepts related to the given field such as 
            ontological information (eg., NCI thesaurus, bioportal etc)
            
            [Autopopulated, if not filled]
        source:
          title: Related Concepts - Source 
          description: |
            The source of the related concept.

            [Autopopulated, if not filled]
          type: string
          examples:
            - TBD (will have controlled vocabulary)
        id:
          title: Related Concepts - Id
          type: string
          description: |
            The id locating the individual mapping within the given source.

            [Autopopulated, if not filled]
  univarStats:
    type: object
    description: |
      Univariate statistics inferred from the data about the given variable 
      
      [Experimental]
    properties:
      median:
        type: number
      mean:
        type: number
      std:
        type: number
      min:
        type: number
      max:
        type: number
      mode:
        type: number
      count:
        type: integer
        minimum: 0
      twentyFifthPercentile:
        type: number
      seventyFifthPercentile:
        type: number
      categoricalMarginals:
        type: array
        items:
          type: object
          properties:
            name:
              type: string
            count:
              type: integer
