---
"$schema": http://json-schema.org/draft-04/schema#
"$id": 'variable'
title: HEAL Variable Level Metadata 
description: >
  Variable level metadata (i.e., data dictionary) associated with a single file (i.e., resource)
type: object
required:
- name
- description
properties:
  # is this needed?
  # id:
  #   type: string
  #   title: Variable ID
  name:
    type: string
    title: Variable Name
    description: >
      The name of a variable (i.e., field) as it appears in the data.
  title:
    type: string
    title: Variable Label (ie Title)
    description: The human-readable title of the variable.
  type: #TODO: include enum of all potential type values?
    type: string
    title: Variable Type
    description: > 
      A classification allowing the user (analyst, researcher or computer) to know how
      to use the variable
  format:
    type: string
    title: Variable Format
    description: Indicates the format of the type specified in the `type` property
  enum:
    type: array
    title: Variable Possible Values
  # not sure unit is necessary but dbgap has it...
  unit:
    type: string
    title: Variable Units.  
    description: Describes the type of units the variable is in (e.g., year, month, kg, lbs, etc)
  encodings:
    type: object
    title: Variable Value Encodings (i.e., mappings; value labels)
  description:
    type: string
    title: Variable Description
  link:
    type: string
    title: Variable Repository Link
    description: >
      A link to the variable as it exists on the home repository, if applicable
    
  # Study ID to which variable belongs
  # Study Name to which variable belongs
  # Study Link
  cde_id:
    type: array
    items:
      #probably should choose one of these and stick with it?
      oneOf:
        - type: object
          properties:
            source: 
              type: string
            id:
              type: string
        - type: string
          format: uri
        - type: string
          pattern: '.*:.*' # constrain length? type of characters?
        - $ref: '_definitions.yaml#/gen3CdeId'
      spreadsheet: 'source:id in a cell. Examples would be CDE_SOURCE:CDE_ID'
  ontology_id:
    #probably should choose one of these and stick with it?
    oneOf:
      - type: object
        properties:
          source: 
            type: string
          id:
            type: string
      - type: string
        format: uri
      - type: string
        pattern: '.*:.*' # constrain length? type of characters?
    type: array
    title: The Common Data Elements (CDE) ID(s) and its associated source(s) in the form source:id unless explicitly specified.
  univariate_statistics:
  # create if-then based on variable type property
    type: array
    items:
      oneOf:
        type: object
        properties:
          #add categorical counts/rates etc
          name:
            type: string
            enum: 
              - median
              - mean
              - std
              - min
              - max
              - count
              - mode
              - skew
              - kurtosis
              - twenty_five_percentile
              - seventy_five_percentile
            description: >
              The name of the statistical value.
            value:
              # needs to be a string if categorical variable (ordered or otherwise)
              oneOf:
                - type: number 
                - type: integer
                - type: string
    # TODO: multivariate_statistics
    data_files:
      type: array
      title: HEAL Resource Metadata 
      description: >
        Contains information regarding all associated file(s) (i.e, dataset; data resource)
        in which this data dictionary describes.
      items:
        type: object
        properties:
          name:
            type: string #one of if multiple datasets attached to this dd 
            title: Dataset unique identifier
          title:
            type: string
            title: Dataset Title
            description: Human-readable name of the dataset (i.e., file;data resource)
          description: 
            type: string
            title: A description of the dataset/file/resource
          object_id: 
          #TODO: link to the associated data object
          #TODO: other properties for files such as: format, encoding, md5sum, size, etc
          #TODO: other links that reference related files or supplemental files
